# üßë‚Äçüíª DevOps Diploma Project ## üìã –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞ –ü–æ–ª–Ω—ã–π **DevOps —Ü–∏–∫–ª —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è Django –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è** –≤ Kubernetes-–∫–ª–∞—Å—Ç–µ—Ä–µ —Å –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–º –∏ CI/CD –∫–æ–Ω–≤–µ–π–µ—Ä–æ–º. --- ## üåê –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ | –†–æ–ª—å | IP-–∞–¥—Ä–µ—Å | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | |--------------|------------------|----------------------------------| | üß† k8s-master | 158.160.125.160 | Kubernetes Control Plane | | üß© k8s-app | 158.160.115.144 | Kubernetes Worker | | üõ† srv | 158.160.120.153 | CI/CD, –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥, Docker-Registry | --- ## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç ### 1Ô∏è‚É£ –†–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã (Terraform) `bash cd terraform terraform init terraform apply 
2Ô∏è‚É£ –ë–∞–∑–æ–≤–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ (Ansible)
cd ansible ansible-playbook -i inventory.ini 00_full_deployment.yml 
3Ô∏è‚É£ –†—É—á–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è –ø–æ—Å–ª–µ Ansible
–ù–∞ —Å–µ—Ä–≤–µ—Ä–µ SRV:
# Docker Registry docker run -d -p 5000:5000 --restart=always --name registry registry:2 # –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ stack docker-compose -f docker-compose-monitoring.yml up -d 
–ù–∞—Å—Ç—Ä–æ–π–∫–∞ insecure registry –¥–ª—è K3S:
sudo nano /etc/rancher/k3s/registries.yaml 
–î–æ–±–∞–≤–∏—Ç—å:
mirrors: "158.160.120.153:5000": endpoint: ["http://158.160.120.153:5000"] 
–ù–∞ K8S Master:
# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–ª–∞—Å—Ç–µ—Ä–∞ —É–∂–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ —á–µ—Ä–µ–∑ Ansible # –ü–æ–ª—É—á–∏—Ç—å —Ç–æ–∫–µ–Ω –¥–ª—è worker-–Ω–æ–¥—ã: sudo cat /var/lib/rancher/k3s/server/node-token 
–ù–∞ K8S Worker:
# –ü—Ä–∏—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –∫ –∫–ª–∞—Å—Ç–µ—Ä—É curl -sfL https://get.k3s.io | K3S_URL=https://158.160.125.160:6443 K3S_TOKEN=–í–ê–®_–¢–û–ö–ï–ù sh - 
4Ô∏è‚É£ –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
–ß–µ—Ä–µ–∑ CI/CD —Å–∫—Ä–∏–ø—Ç:
./scripts/ci-helm-final.sh v1.0.0 
–ò–ª–∏ –≤—Ä—É—á–Ω—É—é —á–µ—Ä–µ–∑ Helm:
cd helm-charts/django-app helm install my-app . 
üì¶ –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ (Ansible)
Docker, docker-compose
Kubernetes (K3S)
kubectl, helm
Python, pip
SSH –∫–ª—é—á–∏
–†—É—á–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞
Docker Registry (–Ω–∞ SRV)
Prometheus Stack (–Ω–∞ SRV)
Prometheus (–º–µ—Ç—Ä–∏–∫–∏)
Grafana (–¥–∞—à–±–æ—Ä–¥—ã)
Loki (–ª–æ–≥–∏)
Promtail (—Å–±–æ—Ä –ª–æ–≥–æ–≤)
Helm Charts (–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ)
CI/CD —Å–∫—Ä–∏–ø—Ç—ã
üîß –î–æ—Å—Ç—É–ø–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã
–°–µ—Ä–≤–∏—ÅURL–î–æ—Å—Ç—É–øüåç –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µhttp://158.160.125.160:30080 (http://158.160.125.160:30080/)Djangoüìä Grafanahttp://158.160.120.153:3000 (http://158.160.120.153:3000/)admin / admin123üìà Prometheushttp://158.160.120.153:9090 (http://158.160.120.153:9090/)–ú–µ—Ç—Ä–∏–∫–∏üì¶ Docker Registryhttp://158.160.120.153:5000 (http://158.160.120.153:5000/)–•—Ä–∞–Ω–∏–ª–∏—â–µ –æ–±—Ä–∞–∑–æ–≤ 
‚ö†Ô∏è –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
–†–µ—à—ë–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:
‚ùå GitLab –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω ‚Üí ‚úÖ –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω—ã–µ CI/CD —Å–∫—Ä–∏–ø—Ç—ã
üîí –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∏ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤ ‚Üí ‚úÖ –õ–æ–∫–∞–ª—å–Ω—ã–µ Docker-–æ–±—Ä–∞–∑—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
‚öôÔ∏è Insecure registry ‚Üí ‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω registries.yaml –¥–ª—è K3S
–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:
–ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å, —Å—Ç–∞—Ç—É—Å-–∫–æ–¥—ã)
–ú–µ—Ç—Ä–∏–∫–∏ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã (CPU, RAM, –¥–∏—Å–∫)
–õ–æ–≥–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —á–µ—Ä–µ–∑ Loki
Telegram-–∞–ª–µ—Ä—Ç–∏–Ω–≥
üõ† –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
CI/CD
./scripts/ci-helm-final.sh v1.1.0 # –°–±–æ—Ä–∫–∞ –∏ –¥–µ–ø–ª–æ–π –Ω–æ–≤–æ–π –≤–µ—Ä—Å–∏–∏ 
–ë—ç–∫–∞–ø—ã
./scripts/backup-simple.sh # –°–æ–∑–¥–∞–Ω–∏–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–π –∫–æ–ø–∏–∏ –ë–î ./scripts/restore-backup.sh # –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ –±—ç–∫–∞–ø–∞ 
–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
kubectl get all # –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è curl http://localhost:9090/api/v1/alerts # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–∫—Ç–∏–≤–Ω—ã—Ö –∞–ª–µ—Ä—Ç–æ–≤ 
üìû –ê–ª–µ—Ä—Ç–∏–Ω–≥
Telegram-–±–æ—Ç —É–≤–µ–¥–æ–º–ª—è–µ—Ç –ø—Ä–∏:
üü• –ü–∞–¥–µ–Ω–∏–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
üö´ –ù–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ —Å–µ—Ä–≤–∏—Å–æ–≤
üíæ –ó–∞–∫–∞–Ω—á–∏–≤–∞—é—â–µ–º—Å—è –º–µ—Å—Ç–µ –Ω–∞ –¥–∏—Å–∫–µ
‚è±Ô∏è –í—Ä–µ–º—è —Ä–µ–∞–∫—Ü–∏–∏: –º–µ–Ω–µ–µ 5 –º–∏–Ω—É—Ç
